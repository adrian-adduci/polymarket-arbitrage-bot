<!-- Status Panel Partial -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-4">
    <!-- Trading Status -->
    <div class="card">
        <div class="card-body">
            <div class="text-sm font-medium text-gray-500 uppercase tracking-wide">Status</div>
            <div class="mt-1 flex items-center">
                {% if status.is_running %}
                <span class="w-3 h-3 rounded-full bg-green-500 mr-2 live-dot"></span>
                <span class="text-xl font-semibold text-green-600">Running</span>
                {% else %}
                <span class="w-3 h-3 rounded-full bg-gray-400 mr-2"></span>
                <span class="text-xl font-semibold text-gray-600">Stopped</span>
                {% endif %}
            </div>
            <div class="mt-1 text-sm text-gray-500">
                {% if status.strategy %}
                {{ status.strategy }}
                {% if status.is_dry_run %}
                <span class="ml-1 text-xs px-1.5 py-0.5 bg-yellow-100 text-yellow-800 rounded">DRY RUN</span>
                {% else %}
                <span class="ml-1 text-xs px-1.5 py-0.5 bg-green-100 text-green-800 rounded">LIVE</span>
                {% endif %}
                {% else %}
                No strategy selected
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Session P&L -->
    <div class="card">
        <div class="card-body">
            <div class="text-sm font-medium text-gray-500 uppercase tracking-wide">Session P&L</div>
            <div class="mt-1">
                {% set pnl = status.session_pnl|default(0)|float %}
                {% if pnl >= 0 %}
                <span class="text-xl font-semibold text-green-600">${{ "%.2f"|format(pnl) }}</span>
                {% else %}
                <span class="text-xl font-semibold text-red-600">-${{ "%.2f"|format(pnl|abs) }}</span>
                {% endif %}
            </div>
            <div class="mt-1 text-sm text-gray-500">
                Total: ${{ "%.2f"|format(status.total_pnl|default(0)|float) }}
            </div>
        </div>
    </div>

    <!-- Opportunities Found -->
    <div class="card">
        <div class="card-body">
            <div class="text-sm font-medium text-gray-500 uppercase tracking-wide">Opportunities</div>
            <div class="mt-1">
                <span class="text-xl font-semibold text-gray-900">{{ status.opportunities_found|default(0) }}</span>
            </div>
            <div class="mt-1 text-sm text-gray-500">
                Trades: {{ status.trades_executed|default(0) }}
            </div>
        </div>
    </div>

    <!-- Errors -->
    <div class="card">
        <div class="card-body">
            <div class="text-sm font-medium text-gray-500 uppercase tracking-wide">Health</div>
            <div class="mt-1">
                {% set errors = status.errors_count|default(0)|int %}
                {% if errors == 0 %}
                <span class="text-xl font-semibold text-green-600">Healthy</span>
                {% else %}
                <span class="text-xl font-semibold text-yellow-600">{{ errors }} Errors</span>
                {% endif %}
            </div>
            <div class="mt-1 text-sm text-gray-500">
                {{ status.status_message|default("Idle") }}
            </div>
        </div>
    </div>
</div>

<!-- Additional stats row -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
    <!-- Open Positions -->
    <div class="card">
        <div class="card-body py-3">
            <div class="flex items-center justify-between">
                <div class="text-sm font-medium text-gray-500">Open Positions</div>
                <div class="text-lg font-semibold text-gray-900">{{ status.open_positions|default(0) }}</div>
            </div>
        </div>
    </div>

    <!-- Uptime -->
    <div class="card">
        <div class="card-body py-3">
            <div class="flex items-center justify-between">
                <div class="text-sm font-medium text-gray-500">Uptime</div>
                <div class="text-lg font-semibold text-gray-900">
                    {% if status.uptime_seconds %}
                    {% set hours = status.uptime_seconds // 3600 %}
                    {% set minutes = (status.uptime_seconds % 3600) // 60 %}
                    {% if hours > 0 %}{{ hours }}h {% endif %}{{ minutes }}m
                    {% else %}
                    --
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Last Heartbeat -->
    <div class="card">
        <div class="card-body py-3">
            <div class="flex items-center justify-between">
                <div class="text-sm font-medium text-gray-500">Last Heartbeat</div>
                <div class="text-lg font-semibold text-gray-900">
                    {% if status.heartbeat_age_seconds is defined and status.heartbeat_age_seconds is not none %}
                    {% if status.heartbeat_age_seconds < 60 %}
                    {{ status.heartbeat_age_seconds }}s ago
                    {% else %}
                    {{ status.heartbeat_age_seconds // 60 }}m ago
                    {% endif %}
                    {% else %}
                    --
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>
